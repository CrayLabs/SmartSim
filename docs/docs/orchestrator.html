

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Orchestrator &#8212; SmartSim 0.8.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom_tab_style.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="_static/design-tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'orchestrator';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Logger" href="ss_logger.html" />
    <link rel="prev" title="Ensemble" href="ensemble.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">SmartSim 0.8.0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="versions.html">Versions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation_instructions/basic.html">Basic Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation_instructions/platform.html">Installation on specific platforms</a></li>








<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="smartsim_zoo.html">Contributing Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tutorials/getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/online_analysis/lattice/online_analysis.html">Online Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/ml_inference/Inference-in-SmartSim.html">Online Inference</a></li>

<li class="toctree-l1"><a class="reference internal" href="tutorials/ml_training/surrogate/train_surrogate.html">Online Training</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SmartSim</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="experiment.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_settings.html">Run Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch_settings.html">Batch Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">Ensemble</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Orchestrator</a></li>
<li class="toctree-l1"><a class="reference internal" href="ss_logger.html">Logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml_features.html">ML Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="dragon.html">Dragon</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/smartsim_api.html">SmartSim API</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SmartRedis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="smartredis.html">SmartRedis</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_integration.html">Integrating into a Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_python_walkthrough.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_cpp_walkthrough.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_fortran_walkthrough.html">Fortran</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_data_structures.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_dataset_conversions.html">DataSet Conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_runtime.html">Runtime Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="sr_advanced_topics.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/smartredis_api.html">SmartRedis API</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SmartDashboard</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="smartdashboard.html">SmartDashboard</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/CrayLabs/SmartSim" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/CrayLabs/SmartSim/issues/new?title=Issue%20on%20page%20%2Forchestrator.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/orchestrator.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Orchestrator</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standalone-deployment">Standalone Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#application-script">Application Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#client-initialization">Client Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval">Data Retrieval</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-storage">Data Storage</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-driver-script">Experiment Driver Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#orchestrator-initialization">Orchestrator Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Client Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Data Storage</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#model-initialization">Model Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#file-generation">File Generation</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#entity-deployment">Entity Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-start-orchestrator">Step 1: Start Orchestrator</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-start-model">Step 2: Start Model</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-polling">Data Polling</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup">Cleanup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-deployment">Colocated Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-orch-app-script">Application Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Client Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Data Storage</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Data Retrieval</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-orch-driver-script">Experiment Driver Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-model-initialization">Colocated Model Initialization</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-configure">Step 1: Configure</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-initialize">Step 2: Initialize</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-colocate">Step 3: Colocate</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-generate-files">Step 4: Generate Files</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-start">Step 5: Start</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Cleanup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-orchestrators">Multiple Orchestrators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-orchestrator-example">Multiple Orchestrator Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-application-script">The Application Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-the-clients">Initialize the Clients</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-initialize-configoptions">Step 1: Initialize ConfigOptions</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-initialize-the-client-connections">Step 2: Initialize the Client Connections</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data-and-store-using-smartredis-client-objects">Retrieve Data and Store Using SmartRedis Client Objects</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-experiment-driver-script">The Experiment Driver Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#launch-multiple-orchestrators">Launch Multiple Orchestrators</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-initialize-orchestrators">Step 1: Initialize Orchestrators</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-start">Step 2: Start</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#create-client-connections-to-orchestrators">Create Client Connections to Orchestrators</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#store-data-using-clients">Store Data Using Clients</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-a-colocated-model">Initialize a Colocated Model</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Step 1: Configure</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Step 2: Initialize</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-colocate">Step 2: Colocate</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-start">Step 3: Start</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup-experiment">Cleanup Experiment</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-the-example">How to Run the Example</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#application-source-code">Application Source Code</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-source-code">Experiment Source Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="orchestrator">
<span id="orch-docs"></span><h1>Orchestrator<a class="headerlink" href="#orchestrator" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is an in-memory database with features built for
AI-enabled workflows including online training, low-latency inference, cross-application data
exchange, online interactive visualization, online data analysis, computational steering, and more.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> can be thought of as a general feature store
capable of storing numerical data (tensors and <code class="docutils literal notranslate"><span class="pre">Datasets</span></code>), AI models (TF, TF-lite, PyTorch, or ONNX),
and scripts (TorchScripts). In addition to storing data, the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is capable of
executing AI models and TorchScripts on the stored data using CPUs or GPUs.</p>
<figure class="align-default" id="id14">
<img alt="_images/smartsim-arch.png" src="_images/smartsim-arch.png" />
<figcaption>
<p><span class="caption-text">Sample <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> showing a user application leveraging
machine learning infrastructure launched by SmartSim and connected
to an online analysis and visualization simulation via the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</span><a class="headerlink" href="#id14" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Users can establish a connection to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> from within <code class="docutils literal notranslate"><span class="pre">Model</span></code> executable code, <code class="docutils literal notranslate"><span class="pre">Ensemble</span></code>
member executable code, or <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver scripts by using the
<a class="reference internal" href="api/smartredis_api.html#smartredis-api"><span class="std std-ref">SmartRedis</span></a> <code class="docutils literal notranslate"><span class="pre">Client</span></code> library.</p>
<p>SmartSim offers <strong>two</strong> types of <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> deployments:</p>
<ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="#standalone-orch-doc"><span class="std std-ref">Standalone Deployment</span></a></dt><dd><p>A standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is ideal for systems that have heterogeneous node types
(i.e. a mix of CPU-only and GPU-enabled compute nodes) where
ML model and TorchScript evaluation is more efficiently performed off-node. This
deployment is also ideal for workflows relying on data exchange between multiple
applications (e.g. online analysis, visualization, computational steering, or
producer/consumer application couplings). Standalone deployment is also optimal for
high data throughput scenarios where <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> require large amounts of compute resources.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#colocated-orch-doc"><span class="std std-ref">Colocated Deployment</span></a></dt><dd><p>A colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is ideal when the data and hardware accelerator are located on the same compute node.
This setup helps reduce latency in ML inference and TorchScript evaluation by eliminating off-node communication.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Colocated <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> cannot share data across compute nodes.
Communication is only supported between a <code class="docutils literal notranslate"><span class="pre">Model</span></code> and colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> pair.</p>
</div>
<p>SmartSim allows users to launch <a class="reference internal" href="#mutli-orch-doc"><span class="std std-ref">multiple Orchestrators</span></a> of either type during
the course of an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>. If a workflow requires a multiple <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> environment, a
<cite>db_identifier</cite> argument must be specified during <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> initialization. Users can connect to
<code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> in a multiple <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> workflow by specifying the respective <cite>db_identifier</cite> argument
within a <a class="reference internal" href="sr_advanced_topics.html#config-options-explain"><span class="std std-ref">ConfigOptions</span></a> object that is passed into the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor.</p>
</section>
<section id="standalone-deployment">
<span id="standalone-orch-doc"></span><h2>Standalone Deployment<a class="headerlink" href="#standalone-deployment" title="Permalink to this heading">#</a></h2>
<section id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>During standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> deployment, a SmartSim <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> (the database) runs on separate
compute node(s) from the SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> node(s). A standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> can be deployed on a single
node (single-sharded) or distributed (sharded) over multiple nodes. With a multi-node <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, users can
scale the number of database nodes for inference and script evaluation, enabling
increased in-memory capacity for data storage in large-scale workflows. Single-node
<code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> are effective for small-scale workflows and offer lower latency for <code class="docutils literal notranslate"><span class="pre">Client</span></code> API calls
that involve data appending or processing (e.g. <code class="docutils literal notranslate"><span class="pre">Client.append_to_list</span></code>, <code class="docutils literal notranslate"><span class="pre">Client.run_model</span></code>, etc).</p>
<p>When connecting to a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> from within a <code class="docutils literal notranslate"><span class="pre">Model</span></code> application, the user has
several options to connect a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>:</p>
<ul class="simple">
<li><p>In an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> with a single deployed <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, users can rely on SmartRedis
to detect the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> address through runtime configuration of the SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> environment.
A default <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor, with no user-specified parameters, is sufficient to
connect to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. The only exception is for the Python <code class="docutils literal notranslate"><span class="pre">Client</span></code>, which requires
the <cite>cluster</cite> constructor parameter to differentiate between standalone deployment and colocated
deployment.</p></li>
<li><p>In an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> with multiple <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>, users can connect to a specific <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> by
first specifying the <cite>db_identifier</cite> in the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> constructor within the executable application.
Subsequently, users should pass the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> instance to the <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor.</p></li>
<li><p>Users can specify or override automatically configured connection options by providing the
<code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> address in the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> object. Subsequently, users should pass the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code>
instance to the <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor.</p></li>
</ul>
<p>If connecting to a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> from a <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script, the user must specify
the address of the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> to the <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor. SmartSim does not automatically
configure the environment of the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script to connect to an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. Users
can access an <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> address through <code class="docutils literal notranslate"><span class="pre">Orchestrator.get_address</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> applications, it is advisable to <strong>avoid</strong> specifying addresses directly to the <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor.
Utilizing the SmartSim environment configuration for SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> connections
allows the SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> application code to remain unchanged even as <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> deployment
options vary.</p>
</div>
<p>The following image illustrates
communication between a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> and a
SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code>. In the diagram, the application is running on multiple compute nodes,
separate from the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> compute nodes. Communication is established between the
<code class="docutils literal notranslate"><span class="pre">Model</span></code> application and the sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> using the <a class="reference internal" href="api/smartredis_api.html#smartredis-api"><span class="std std-ref">SmartRedis client</span></a>.</p>
<figure class="align-default" id="id15">
<img alt="_images/clustered_orchestrator-1.png" src="_images/clustered_orchestrator-1.png" />
<figcaption>
<p><span class="caption-text">Sample Standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> Deployment</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users do not need to know how the data is stored in a standalone configuration and
can address the cluster with the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> like a single block of memory
using simple put/get semantics in SmartRedis.</p>
</div>
<p>In scenarios where data needs to be shared amongst <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> entities,
such as online analysis, training, and processing, a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>
is optimal. The data produced by multiple processes in a <code class="docutils literal notranslate"><span class="pre">Model</span></code> is stored in the standalone
<code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> and is available for consumption by other <code class="docutils literal notranslate"><span class="pre">Model</span></code>’s.</p>
<p>If a workflow requires an application to leverage multiple standalone deployments,
multiple <code class="docutils literal notranslate"><span class="pre">Clients</span></code> can be instantiated within an application,
with each <code class="docutils literal notranslate"><span class="pre">Client</span></code> connected to a unique <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. This is accomplished through the use of the
<cite>db-identifier</cite> and <a class="reference internal" href="sr_advanced_topics.html#config-options-explain"><span class="std std-ref">ConfigOptions</span></a> object specified at <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> initialization time.
For more information on a multiple database <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, visit the <a class="reference internal" href="#mutli-orch"><span class="std std-ref">Multiple Orchestrators</span></a> section on
this page.</p>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h3>
<p>In the following example, we demonstrate deploying a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> on an HPC system.
Once the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is launched from the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script, we walk through
connecting a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> from within the <code class="docutils literal notranslate"><span class="pre">Model</span></code>
application to transmit and poll for data.</p>
<p>The example is comprised of two script files:</p>
<ul>
<li><dl>
<dt><a class="reference internal" href="#standalone-orch-app-script"><span class="std std-ref">Application Script</span></a></dt><dd><p>The application script is a Python file that contains instructions to create a SmartRedis
<code class="docutils literal notranslate"><span class="pre">Client</span></code> connection to the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. To demonstrate the ability of
workflow components to access data from other entities, we retrieve the tensors set by
the driver script using a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> in the application script. We then instruct
the <code class="docutils literal notranslate"><span class="pre">Client</span></code> to send and retrieve data from within the application script. The example source
code is available in the dropdown below for convenient execution and customization.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Example Application Script source code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LLInfo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Initialize a SmartRedis Client</span>
<span class="n">application_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Retrieve the driver script tensor from Orchestrator</span>
<span class="n">driver_script_tensor</span> <span class="o">=</span> <span class="n">application_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="c1"># Log the tensor</span>
<span class="n">application_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The multi-sharded db tensor is: </span><span class="si">{</span><span class="n">driver_script_tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Create a NumPy array</span>
<span class="n">local_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="c1"># Use SmartRedis client to place tensor in multi-sharded db</span>
<span class="n">application_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="n">local_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details></dd>
</dl>
</li>
<li><dl>
<dt><a class="reference internal" href="#standalone-orch-driver-script"><span class="std std-ref">Experiment Driver Script</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script is responsible for launching and managing SmartSim entities. Within this script,
we use the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> API to create and launch a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. To demonstrate the capability of
a <code class="docutils literal notranslate"><span class="pre">Model</span></code> application to access <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> data sent from other sources, we employ the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> in
the driver script to store a tensor in the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, which is later retrieved by the <code class="docutils literal notranslate"><span class="pre">Model</span></code> application.
To employ the application script, we initialize a <code class="docutils literal notranslate"><span class="pre">Model</span></code> object with the application script as the executable,
launch the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, and then launch the <code class="docutils literal notranslate"><span class="pre">Model</span></code>.</p>
<p>To further demonstrate the ability of workflow components to access data from
other entities, we retrieve the tensors stored by the completed <code class="docutils literal notranslate"><span class="pre">Model</span></code> using a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> in
the driver script. Lastly, we tear down the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. The example source code is available in the dropdown below for
convenient execution and customization.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Example Experiment Driver Script Source Code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">smartsim</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">smartsim.log</span> <span class="kn">import</span> <span class="n">get_logger</span>

<span class="c1"># Initialize the logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;Example Experiment Log&quot;</span><span class="p">)</span>
<span class="c1"># Initialize the Experiment</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="s2">&quot;getting-started&quot;</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="c1"># Initialize a multi-sharded Orchestrator</span>
<span class="n">standalone_orchestrator</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">db_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Initialize a SmartRedis client for multi-sharded Orchestrator</span>
<span class="n">driver_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">standalone_orchestrator</span><span class="o">.</span><span class="n">get_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Create NumPy array</span>
<span class="n">local_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="c1"># Use the SmartRedis client to place tensor in the standalone Orchestrator</span>
<span class="n">driver_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">local_array</span><span class="p">)</span>

<span class="c1"># Initialize a RunSettings object</span>
<span class="n">model_settings</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_run_settings</span><span class="p">(</span><span class="n">exe</span><span class="o">=</span><span class="s2">&quot;/path/to/executable_simulation&quot;</span><span class="p">)</span>
<span class="n">model_settings</span><span class="o">.</span><span class="n">set_nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Initialize the Model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">)</span>

<span class="c1"># Create the output directory</span>
<span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">standalone_orchestrator</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

<span class="c1"># Launch the multi-sharded Orchestrator</span>
<span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">standalone_orchestrator</span><span class="p">)</span>

<span class="c1"># Launch the Model</span>
<span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Poll the tensors placed by the Model</span>
<span class="n">app_tensor</span> <span class="o">=</span> <span class="n">driver_client</span><span class="o">.</span><span class="n">poll_key</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="c1"># Validate that the tensor exists</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The tensor exists: </span><span class="si">{</span><span class="n">app_tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Cleanup the Orchestrator</span>
<span class="n">exp</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">standalone_orchestrator</span><span class="p">)</span>
<span class="c1"># Print the Experiment summary</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</details></dd>
</dl>
</li>
</ul>
<section id="application-script">
<span id="standalone-orch-app-script"></span><h4>Application Script<a class="headerlink" href="#application-script" title="Permalink to this heading">#</a></h4>
<p>To begin writing the application script, import the necessary SmartRedis packages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LLInfo</span>
<span class="linenos">2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<section id="client-initialization">
<h5>Client Initialization<a class="headerlink" href="#client-initialization" title="Permalink to this heading">#</a></h5>
<p>To establish a connection with the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, we need to initialize a new SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>.
Because the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> launched in the driver script is sharded, we specify the
constructor argument <cite>cluster</cite> as <cite>True</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartRedis Client</span>
<span class="linenos">2</span><span class="n">application_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the C/C++/Fortran SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> are capable of reading cluster configurations
from the SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> environment and the <cite>cluster</cite> constructor argument does not need to be specified
in those <code class="docutils literal notranslate"><span class="pre">Client</span></code> languages.</p>
</div>
<p>Since there is only one <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> launched in the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>
(the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>), specifying an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> <cite>db_identifier</cite>
is <strong>not</strong> required when initializing the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>.
SmartRedis will handle the connection configuration.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To create a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> connection to the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> must be launched
from within the driver script prior to the start of the <code class="docutils literal notranslate"><span class="pre">Model</span></code>.</p>
</div>
</section>
<section id="data-retrieval">
<h5>Data Retrieval<a class="headerlink" href="#data-retrieval" title="Permalink to this heading">#</a></h5>
<p>To confirm a successful connection to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, we retrieve the tensor set from the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> script.
Use the <code class="docutils literal notranslate"><span class="pre">Client.get_tensor</span></code> method to retrieve the tensor named <cite>tensor_1</cite> placed by the driver script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Retrieve the driver script tensor from Orchestrator</span>
<span class="linenos">2</span><span class="n">driver_script_tensor</span> <span class="o">=</span> <span class="n">application_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="c1"># Log the tensor</span>
<span class="linenos">4</span><span class="n">application_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The multi-sharded db tensor is: </span><span class="si">{</span><span class="n">driver_script_tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>After the <code class="docutils literal notranslate"><span class="pre">Model</span></code> is launched by the driver script, the following output will appear in
<cite>getting-started/model/model.out</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Default</span><span class="o">@</span><span class="mi">17</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">48</span><span class="p">:</span><span class="n">The</span> <span class="n">multi</span><span class="o">-</span><span class="n">sharded</span> <span class="n">db</span> <span class="n">tensor</span> <span class="ow">is</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="data-storage">
<h5>Data Storage<a class="headerlink" href="#data-storage" title="Permalink to this heading">#</a></h5>
<p>Next, create a NumPy tensor to send to the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> using
<code class="docutils literal notranslate"><span class="pre">Client.put_tensor(name,</span> <span class="pre">data)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Create a NumPy array</span>
<span class="linenos">2</span><span class="n">local_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="linenos">3</span><span class="c1"># Use SmartRedis client to place tensor in multi-sharded db</span>
<span class="linenos">4</span><span class="n">application_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="n">local_array</span><span class="p">)</span>
</pre></div>
</div>
<p>We retrieve <cite>“tensor_2”</cite> in the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script.</p>
</section>
</section>
<section id="experiment-driver-script">
<span id="standalone-orch-driver-script"></span><h4>Experiment Driver Script<a class="headerlink" href="#experiment-driver-script" title="Permalink to this heading">#</a></h4>
<p>To run the previous application script, we define a <code class="docutils literal notranslate"><span class="pre">Model</span></code> and <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> within the
<code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script. Configuring and launching workflow entities (<code class="docutils literal notranslate"><span class="pre">Model</span></code> and <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>) requires the utilization of
<code class="docutils literal notranslate"><span class="pre">Experiment</span></code> class methods. The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object is intended to be instantiated
once and utilized throughout the workflow runtime.</p>
<p>In this example, we instantiate an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object with the name <cite>getting-started</cite>
and the <cite>launcher</cite> set to <cite>auto</cite>. When using <cite>launcher=auto</cite>, SmartSim attempts to find a launcher on the machine.
For example, if this script were run on a Slurm-based system, SmartSim will automatically set the launcher to <cite>slurm</cite>.
We also setup the SmartSim <cite>logger</cite> to output information from the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> at runtime:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">smartsim</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="linenos">4</span><span class="kn">from</span> <span class="nn">smartsim.log</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1"># Initialize the logger</span>
<span class="linenos">7</span><span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;Example Experiment Log&quot;</span><span class="p">)</span>
<span class="linenos">8</span><span class="c1"># Initialize the Experiment</span>
<span class="linenos">9</span><span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="s2">&quot;getting-started&quot;</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="orchestrator-initialization">
<h5>Orchestrator Initialization<a class="headerlink" href="#orchestrator-initialization" title="Permalink to this heading">#</a></h5>
<p>In the next stage of the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, we create a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
<p>To create a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, utilize the <code class="docutils literal notranslate"><span class="pre">Experiment.create_database</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a multi-sharded Orchestrator</span>
<span class="linenos">2</span><span class="n">standalone_orchestrator</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">db_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id2">
<h5>Client Initialization<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h5>
<p>The SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> object contains functions that manipulate, send, and retrieve
data on the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. Begin by initializing a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> object for the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
<p>SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> in driver scripts do not have the ability to use a <cite>db-identifier</cite> or
rely on automatic configurations to connect to <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>. Therefore, when creating a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>
connection from within a driver script, specify the address of the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> you would like to connect to.
You can easily retrieve the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> address using the <code class="docutils literal notranslate"><span class="pre">Orchestrator.get_address</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartRedis client for multi-sharded Orchestrator</span>
<span class="linenos">2</span><span class="n">driver_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">standalone_orchestrator</span><span class="o">.</span><span class="n">get_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="id3">
<h5>Data Storage<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h5>
<p>In the application script, we retrieved a NumPy tensor stored from within the driver script.
To support the application functionality, we create a
NumPy array in the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script to send to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. To
send a tensor to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, use the function <code class="docutils literal notranslate"><span class="pre">Client.put_tensor(name,</span> <span class="pre">data)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Create NumPy array</span>
<span class="linenos">2</span><span class="n">local_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="linenos">3</span><span class="c1"># Use the SmartRedis client to place tensor in the standalone Orchestrator</span>
<span class="linenos">4</span><span class="n">driver_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">local_array</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="model-initialization">
<h5>Model Initialization<a class="headerlink" href="#model-initialization" title="Permalink to this heading">#</a></h5>
<p>In the next stage of the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, we configure and create
a SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> and specify the executable path during <code class="docutils literal notranslate"><span class="pre">Model</span></code> creation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a RunSettings object</span>
<span class="linenos">2</span><span class="n">model_settings</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_run_settings</span><span class="p">(</span><span class="n">exe</span><span class="o">=</span><span class="s2">&quot;/path/to/executable_simulation&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">model_settings</span><span class="o">.</span><span class="n">set_nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="c1"># Initialize the Model</span>
<span class="linenos">6</span><span class="n">model</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="file-generation">
<h5>File Generation<a class="headerlink" href="#file-generation" title="Permalink to this heading">#</a></h5>
<p>To create an isolated output directory for the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> and <code class="docutils literal notranslate"><span class="pre">Model</span></code>, invoke <code class="docutils literal notranslate"><span class="pre">Experiment.generate</span></code> on the
<code class="docutils literal notranslate"><span class="pre">Experiment</span></code> instance <cite>exp</cite> with <cite>standalone_orchestrator</cite> and <cite>model</cite> as input parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Create the output directory</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">standalone_orchestrator</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>Invoking <code class="docutils literal notranslate"><span class="pre">Experiment.generate(standalone_orchestrator,</span> <span class="pre">model)</span></code> will create two directories:
<cite>standalone_orchestrator/</cite> and <cite>model/</cite>. Each of these directories will store
two output files: a <cite>.out</cite> file and a <cite>.err</cite> file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to invoke <code class="docutils literal notranslate"><span class="pre">Experiment.generate</span></code> with all <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> entity instances
before launching. This will ensure that the output files are organized in the main <code class="docutils literal notranslate"><span class="pre">experiment-name/</span></code>
folder. In this example, the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> folder is named <cite>getting-started/</cite>.</p>
</div>
</section>
<section id="entity-deployment">
<h5>Entity Deployment<a class="headerlink" href="#entity-deployment" title="Permalink to this heading">#</a></h5>
<p>In the next stage of the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, we launch the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, then launch the <code class="docutils literal notranslate"><span class="pre">Model</span></code>.</p>
<section id="step-1-start-orchestrator">
<h6>Step 1: Start Orchestrator<a class="headerlink" href="#step-1-start-orchestrator" title="Permalink to this heading">#</a></h6>
<p>In the context of this <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, it’s essential to create and launch
the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> as a preliminary step before any other workflow entities. This is important
because the application requests and sends tensors to a launched <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
<p>To launch the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, pass the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> instance to <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Launch the multi-sharded Orchestrator</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">standalone_orchestrator</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code> function launches the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> for use within the workflow.
In other words, the function deploys the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> on the allocated compute resources.</p>
</section>
<section id="step-2-start-model">
<h6>Step 2: Start Model<a class="headerlink" href="#step-2-start-model" title="Permalink to this heading">#</a></h6>
<p>Next, launch the <cite>model</cite> instance using the <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Launch the Model</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>In the next subsection, we request tensors placed by the <code class="docutils literal notranslate"><span class="pre">Model</span></code> application.
We specify <cite>block=True</cite> to <code class="docutils literal notranslate"><span class="pre">exp.start</span></code> to require the <code class="docutils literal notranslate"><span class="pre">Model</span></code> to finish before
the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> continues.</p>
</section>
</section>
<section id="data-polling">
<h5>Data Polling<a class="headerlink" href="#data-polling" title="Permalink to this heading">#</a></h5>
<p>Next, check if the tensor exists in the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> using <code class="docutils literal notranslate"><span class="pre">Client.poll_tensor</span></code>.
This function queries for data in the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. The function requires the tensor name (<cite>name</cite>),
how many milliseconds to wait in between queries (<cite>poll_frequency_ms</cite>),
and the total number of times to query (<cite>num_tries</cite>). Check if the data exists in the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> by
polling every 100 milliseconds until 10 attempts have completed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Poll the tensors placed by the Model</span>
<span class="linenos">2</span><span class="n">app_tensor</span> <span class="o">=</span> <span class="n">driver_client</span><span class="o">.</span><span class="n">poll_key</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">3</span><span class="c1"># Validate that the tensor exists</span>
<span class="linenos">4</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The tensor exists: </span><span class="si">{</span><span class="n">app_tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When you execute the driver script, the output will be as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">23</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="mi">46</span> <span class="n">system</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">com</span> <span class="n">SmartSim</span><span class="p">[</span><span class="mi">87400</span><span class="p">]</span> <span class="n">INFO</span> <span class="n">The</span> <span class="n">tensor</span> <span class="n">exists</span><span class="p">:</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="cleanup">
<h5>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this heading">#</a></h5>
<p>Finally, use the <code class="docutils literal notranslate"><span class="pre">Experiment.stop</span></code> function to stop the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> instance. Print the
workflow summary with <code class="docutils literal notranslate"><span class="pre">Experiment.summary</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Cleanup the Orchestrator</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">standalone_orchestrator</span><span class="p">)</span>
<span class="linenos">3</span><span class="c1"># Print the Experiment summary</span>
<span class="linenos">4</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<p>When you run the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, the following output will appear:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>    <span class="o">|</span> <span class="n">Name</span>           <span class="o">|</span> <span class="n">Entity</span><span class="o">-</span><span class="n">Type</span>   <span class="o">|</span> <span class="n">JobID</span>       <span class="o">|</span> <span class="n">RunID</span>   <span class="o">|</span> <span class="n">Time</span>    <span class="o">|</span> <span class="n">Status</span>    <span class="o">|</span> <span class="n">Returncode</span>   <span class="o">|</span>
<span class="o">|----|----------------|---------------|-------------|---------|---------|-----------|--------------|</span>
<span class="o">|</span> <span class="mi">0</span>  <span class="o">|</span> <span class="n">model</span>          <span class="o">|</span> <span class="n">Model</span>         <span class="o">|</span> <span class="mf">1658679.3</span>   <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="mf">1.3342</span>  <span class="o">|</span> <span class="n">Completed</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>  <span class="o">|</span> <span class="n">orchestrator_0</span> <span class="o">|</span> <span class="n">DBNode</span>        <span class="o">|</span> <span class="mf">1658679.2</span><span class="o">+</span><span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="mf">42.8742</span> <span class="o">|</span> <span class="n">Cancelled</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="colocated-deployment">
<span id="colocated-orch-doc"></span><h2>Colocated Deployment<a class="headerlink" href="#colocated-deployment" title="Permalink to this heading">#</a></h2>
<section id="id4">
<h3>Overview<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>During colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> deployment, a SmartSim <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> (the database) runs on
the <code class="docutils literal notranslate"><span class="pre">Model</span></code>’s compute node(s). Colocated <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> can only be deployed as isolated instances
on each compute node and cannot be clustered over multiple nodes. The <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> on each application node is
utilized by SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> on the same node. With a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, all interactions
with the database occur on the same node, thus resulting in lower latency compared to the standard <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.
A colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is ideal when the data and hardware accelerator are located on the
same compute node.</p>
<p>Communication between a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> and <code class="docutils literal notranslate"><span class="pre">Model</span></code> is initiated in the application through a
SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>. Since a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is launched when the <code class="docutils literal notranslate"><span class="pre">Model</span></code>
is started by the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, connecting a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> to a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is only possible from within
the associated <code class="docutils literal notranslate"><span class="pre">Model</span></code> application.</p>
<p>There are <strong>three</strong> methods for connecting the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> to the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<ul class="simple">
<li><p>In an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> with a single deployed <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, users can rely on SmartRedis
to detect the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> address through runtime configuration of the SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code> environment.
A default <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor, with no user-specified parameters, is sufficient to
connect to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. The only exception is for the Python <code class="docutils literal notranslate"><span class="pre">Client</span></code>, which requires
the <cite>cluster=False</cite> constructor parameter for the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p></li>
<li><p>In an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> with multiple <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>, users can connect to a specific <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> by
first specifying the <cite>db_identifier</cite> in the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> constructor. Subsequently, users should pass the
<code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> instance to the <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor.</p></li>
<li><p>Users can specify or override automatically configured connection options by providing the
<code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> address in the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> object. Subsequently, users should pass the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code>
instance to the <code class="docutils literal notranslate"><span class="pre">Client</span></code> constructor.</p></li>
</ul>
<p>Below is an image illustrating communication within a colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code> spanning multiple compute nodes.
As demonstrated in the diagram, each process of the application creates its own SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>
connection to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> running on the same host.</p>
<figure class="align-default" id="id16">
<img alt="_images/colocated_orchestrator-1.png" src="_images/colocated_orchestrator-1.png" />
<figcaption>
<p><span class="caption-text">Sample Colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> Deployment</span><a class="headerlink" href="#id16" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Colocated deployment is ideal for highly performant online inference scenarios where
a distributed application (likely an MPI application) is performing inference with
data local to each process. With colocated deployment, data does not need to travel
off-node to be used to evaluate a ML model, and the results of the ML model evaluation
are stored on-node.</p>
<p>If a workflow requires an application to both leverage colocated
deployment and standalone deployment, multiple <code class="docutils literal notranslate"><span class="pre">Clients</span></code> can be instantiated within an application,
with each <code class="docutils literal notranslate"><span class="pre">Client</span></code> connected to a unique deployment. This is accomplished through the use of the
<cite>db-identifier</cite> specified at <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> initialization time.</p>
</section>
<section id="id5">
<h3>Example<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>In the following example, we demonstrate deploying a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> on an HPC system.
Once the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is launched, we walk through connecting a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>
from within the application script to transmit and poll for data on the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
<p>The example is comprised of two script files:</p>
<ul>
<li><dl>
<dt><a class="reference internal" href="#colocated-orch-app-script"><span class="std std-ref">Application Script</span></a></dt><dd><p>The application script is a Python script that connects a SmartRedis
<code class="docutils literal notranslate"><span class="pre">Client</span></code> to the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. From within the application script,
the <code class="docutils literal notranslate"><span class="pre">Client</span></code> is utilized to both send and retrieve data. The source code example
is available in the dropdown below for convenient execution and customization.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Example Application Script Source Code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LLInfo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Initialize a Client</span>
<span class="n">colo_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Create NumPy array</span>
<span class="n">local_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="c1"># Store the NumPy tensor</span>
<span class="n">colo_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">local_array</span><span class="p">)</span>

<span class="c1"># Retrieve tensor from driver script</span>
<span class="n">local_tensor</span> <span class="o">=</span> <span class="n">colo_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="c1"># Log tensor</span>
<span class="n">colo_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The colocated db tensor is: </span><span class="si">{</span><span class="n">local_tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details></dd>
</dl>
</li>
<li><dl>
<dt><a class="reference internal" href="#colocated-orch-driver-script"><span class="std std-ref">Experiment Driver Script</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script launches and manages
the example entities through the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> API.
In the driver script, we use the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> API
to create and launch a colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code>. The source code example is available
in the dropdown below for convenient execution and customization.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<span class="sd-summary-text">Example Experiment Driver source code</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="kn">from</span> <span class="nn">smartsim</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">smartsim.log</span> <span class="kn">import</span> <span class="n">get_logger</span>

<span class="c1"># Initialize a logger object</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;Example Experiment Log&quot;</span><span class="p">)</span>
<span class="c1"># Initialize the Experiment</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="s2">&quot;getting-started&quot;</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

<span class="c1"># Initialize a RunSettings object</span>
<span class="n">model_settings</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_run_settings</span><span class="p">(</span><span class="n">exe</span><span class="o">=</span><span class="s2">&quot;path/to/executable_simulation&quot;</span><span class="p">)</span>
<span class="c1"># Configure RunSettings object</span>
<span class="n">model_settings</span><span class="o">.</span><span class="n">set_nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Initialize a SmartSim Model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;colo_model&quot;</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">)</span>

<span class="c1"># Colocate the Model</span>
<span class="n">model</span><span class="o">.</span><span class="n">colocate_db_uds</span><span class="p">()</span>

<span class="c1"># Generate output files</span>
<span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># Launch the colocated Model</span>
<span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Log the Experiment summary</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
</details></dd>
</dl>
</li>
</ul>
<section id="colocated-orch-app-script">
<span id="id6"></span><h4>Application Script<a class="headerlink" href="#colocated-orch-app-script" title="Permalink to this heading">#</a></h4>
<p>To begin writing the application script, import the necessary SmartRedis packages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LLInfo</span>
<span class="linenos">2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<section id="id7">
<h5>Client Initialization<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h5>
<p>To establish a connection with the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, we need to initialize a
new SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> and specify <cite>cluster=False</cite> since colocated deployments are never
clustered but only single-sharded.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a Client</span>
<span class="linenos">2</span><span class="n">colo_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the C/C++/Fortran SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> are capable of reading cluster configurations
from the <code class="docutils literal notranslate"><span class="pre">Model</span></code> environment and the <cite>cluster</cite> constructor argument does not need to be specified
in those <code class="docutils literal notranslate"><span class="pre">Client</span></code> languages.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since there is only one <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> launched in the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>
(the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>), specifying a <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> <cite>db_identifier</cite>
is not required when initializing the <code class="docutils literal notranslate"><span class="pre">Client</span></code>. SmartRedis will handle the
connection configuration.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To create a <code class="docutils literal notranslate"><span class="pre">Client</span></code> connection to the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, the colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code> must be launched
from within the driver script. You must execute the Python driver script, otherwise, there will
be no <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> to connect the <code class="docutils literal notranslate"><span class="pre">Client</span></code> to.</p>
</div>
</section>
<section id="id8">
<h5>Data Storage<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h5>
<p>Next, using the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> instance, we create and store a NumPy tensor through
<code class="docutils literal notranslate"><span class="pre">Client.put_tensor(name,</span> <span class="pre">data)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Create NumPy array</span>
<span class="linenos">2</span><span class="n">local_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="linenos">3</span><span class="c1"># Store the NumPy tensor</span>
<span class="linenos">4</span><span class="n">colo_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">local_array</span><span class="p">)</span>
</pre></div>
</div>
<p>We will retrieve <cite>“tensor_1”</cite> in the following section.</p>
</section>
<section id="id9">
<h5>Data Retrieval<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h5>
<p>To confirm a successful connection to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, we retrieve the tensor we stored.
Use the <code class="docutils literal notranslate"><span class="pre">Client.get_tensor</span></code> method to retrieve the tensor by specifying the name
<cite>“tensor_1”</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Retrieve tensor from driver script</span>
<span class="linenos">2</span><span class="n">local_tensor</span> <span class="o">=</span> <span class="n">colo_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="c1"># Log tensor</span>
<span class="linenos">4</span><span class="n">colo_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The colocated db tensor is: </span><span class="si">{</span><span class="n">local_tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> completes, you can find the following log message in <cite>colo_model.out</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Default</span><span class="o">@</span><span class="mi">21</span><span class="o">-</span><span class="mi">48</span><span class="o">-</span><span class="mi">01</span><span class="p">:</span><span class="n">The</span> <span class="n">colocated</span> <span class="n">db</span> <span class="n">tensor</span> <span class="ow">is</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="colocated-orch-driver-script">
<span id="id10"></span><h4>Experiment Driver Script<a class="headerlink" href="#colocated-orch-driver-script" title="Permalink to this heading">#</a></h4>
<p>To run the previous application script, a <code class="docutils literal notranslate"><span class="pre">Model</span></code> object must be configured and launched within the
<code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script. Configuring and launching workflow entities (<code class="docutils literal notranslate"><span class="pre">Model</span></code>)
requires the utilization of <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> class methods. The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object is intended to
be instantiated once and utilized throughout the workflow runtime.</p>
<p>In this example, we instantiate an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object with the name <cite>getting-started</cite>
and the <cite>launcher</cite> set to <cite>auto</cite>. When using <cite>launcher=auto</cite>, SmartSim attempts to find a launcher on the machine.
In this case, since we are running the example on a Slurm-based machine,
SmartSim will automatically set the launcher to <cite>slurm</cite>. We set up the SmartSim <cite>logger</cite>
to output information from the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> at runtime:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">smartsim</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="linenos">4</span><span class="kn">from</span> <span class="nn">smartsim.log</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="c1"># Initialize a logger object</span>
<span class="linenos">7</span><span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;Example Experiment Log&quot;</span><span class="p">)</span>
<span class="linenos">8</span><span class="c1"># Initialize the Experiment</span>
<span class="linenos">9</span><span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="s2">&quot;getting-started&quot;</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="colocated-model-initialization">
<h5>Colocated Model Initialization<a class="headerlink" href="#colocated-model-initialization" title="Permalink to this heading">#</a></h5>
<p>In the next stage of the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, we create and launch a colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code> that
runs the application script with a <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> on the same compute node.</p>
<section id="step-1-configure">
<h6>Step 1: Configure<a class="headerlink" href="#step-1-configure" title="Permalink to this heading">#</a></h6>
<p>In this example <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, the <code class="docutils literal notranslate"><span class="pre">Model</span></code> application is a Python script as defined in section:
<a class="reference internal" href="#colocated-orch-app-script"><span class="std std-ref">Application Script</span></a>. Before initializing the <code class="docutils literal notranslate"><span class="pre">Model</span></code> object, we must use
<code class="docutils literal notranslate"><span class="pre">Experiment.create_run_settings</span></code> to create a <code class="docutils literal notranslate"><span class="pre">RunSettings</span></code> object that defines how to execute
the <code class="docutils literal notranslate"><span class="pre">Model</span></code>. To launch the Python script in this example workflow, we specify the path to the application
file <cite>application_script.py</cite> as the <cite>exe_args</cite> parameter and the executable <cite>exe_ex</cite> (the Python
executable on this system) as <cite>exe</cite> parameter. The <code class="docutils literal notranslate"><span class="pre">Experiment.create_run_settings</span></code> function
will return a <code class="docutils literal notranslate"><span class="pre">RunSettings</span></code> object that can then be used to initialize the <code class="docutils literal notranslate"><span class="pre">Model</span></code> object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Change the <cite>exe_args</cite> argument to the path of the application script
on your file system to run the example.</p>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">RunSettings</span></code> helper functions to
configure the the distribution of computational tasks (<code class="docutils literal notranslate"><span class="pre">RunSettings.set_nodes</span></code>). In this
example, we specify to SmartSim that we intend the <code class="docutils literal notranslate"><span class="pre">Model</span></code> to run on a single compute node.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a RunSettings object</span>
<span class="linenos">2</span><span class="n">model_settings</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_run_settings</span><span class="p">(</span><span class="n">exe</span><span class="o">=</span><span class="s2">&quot;path/to/executable_simulation&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="c1"># Configure RunSettings object</span>
<span class="linenos">4</span><span class="n">model_settings</span><span class="o">.</span><span class="n">set_nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-2-initialize">
<h6>Step 2: Initialize<a class="headerlink" href="#step-2-initialize" title="Permalink to this heading">#</a></h6>
<p>Next, create a <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance using the <code class="docutils literal notranslate"><span class="pre">Experiment.create_model</span></code> factory method.
Pass the <code class="docutils literal notranslate"><span class="pre">model_settings</span></code> object as input to the method and
assign the returned <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance to the variable <cite>model</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartSim Model</span>
<span class="linenos">2</span><span class="n">model</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;colo_model&quot;</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-3-colocate">
<h6>Step 3: Colocate<a class="headerlink" href="#step-3-colocate" title="Permalink to this heading">#</a></h6>
<p>To colocate an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> with a <code class="docutils literal notranslate"><span class="pre">Model</span></code>, use the <code class="docutils literal notranslate"><span class="pre">Model.colocate_db_uds</span></code> function.
This function will colocate an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> instance with this <code class="docutils literal notranslate"><span class="pre">Model</span></code> over
a Unix domain socket connection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Colocate the Model</span>
<span class="linenos">2</span><span class="n">model</span><span class="o">.</span><span class="n">colocate_db_uds</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="step-4-generate-files">
<h6>Step 4: Generate Files<a class="headerlink" href="#step-4-generate-files" title="Permalink to this heading">#</a></h6>
<p>Next, generate the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> entity directories by passing the <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance to
<code class="docutils literal notranslate"><span class="pre">Experiment.generate</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Generate output files</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-5-start">
<h6>Step 5: Start<a class="headerlink" href="#step-5-start" title="Permalink to this heading">#</a></h6>
<p>Next, launch the colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance using the <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Launch the colocated Model</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id11">
<h5>Cleanup<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is automatically torn down by SmartSim once the colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code>
has finished, we do not need to <cite>stop</cite> the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Log the Experiment summary</span>
<span class="linenos">2</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<p>When you run the experiment, the following output will appear:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span>    <span class="o">|</span> <span class="n">Name</span>   <span class="o">|</span> <span class="n">Entity</span><span class="o">-</span><span class="n">Type</span>   <span class="o">|</span> <span class="n">JobID</span>     <span class="o">|</span> <span class="n">RunID</span>   <span class="o">|</span> <span class="n">Time</span>    <span class="o">|</span> <span class="n">Status</span>    <span class="o">|</span> <span class="n">Returncode</span>   <span class="o">|</span>
<span class="o">|----|--------|---------------|-----------|---------|---------|-----------|--------------|</span>
<span class="o">|</span> <span class="mi">0</span>  <span class="o">|</span> <span class="n">model</span>  <span class="o">|</span> <span class="n">Model</span>         <span class="o">|</span> <span class="mf">1592652.0</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="mf">10.1039</span> <span class="o">|</span> <span class="n">Completed</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="multiple-orchestrators">
<span id="mutli-orch-doc"></span><h2>Multiple Orchestrators<a class="headerlink" href="#multiple-orchestrators" title="Permalink to this heading">#</a></h2>
<p>SmartSim supports automating the deployment of multiple <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>
from within an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>. Communication with the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> via a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> is possible with the
<cite>db_identifier</cite> argument that is required when initializing an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> or
colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code> during a multiple <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>. When initializing a SmartRedis
<code class="docutils literal notranslate"><span class="pre">Client</span></code> during the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, create a <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> object to specify the <cite>db_identifier</cite>
argument used when creating the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. Pass the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> object to
the <code class="docutils literal notranslate"><span class="pre">Client</span></code> init call.</p>
<section id="multiple-orchestrator-example">
<span id="mutli-orch"></span><h3>Multiple Orchestrator Example<a class="headerlink" href="#multiple-orchestrator-example" title="Permalink to this heading">#</a></h3>
<p>SmartSim offers functionality to automate the deployment of multiple
databases, supporting workloads that require multiple
<code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> for a <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>. For instance, a workload may consist of a
simulation with high inference performance demands (necessitating a co-located deployment),
along with an analysis and visualization workflow connected to the simulation
(requiring a standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>). In the following example, we simulate a
simple version of this use case.</p>
<p>The example is comprised of two script files:</p>
<ul class="simple">
<li><p>The Application Script</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> Driver Script</p></li>
</ul>
<p><strong>The Application Script Overview:</strong>
In this example, the application script is a python file that
contains instructions to complete computational
tasks. Applications are not limited to Python
and can also be written in C, C++ and Fortran.
This script specifies creating a Python SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> for each
standalone <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> and a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. We use the
<code class="docutils literal notranslate"><span class="pre">Clients</span></code> to request data from both standalone <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>, then
transfer the data to the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. The application
file is launched by the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script
through a <code class="docutils literal notranslate"><span class="pre">Model</span></code> stage.</p>
<p><strong>The Application Script Contents:</strong></p>
<ol class="arabic simple">
<li><p>Connecting SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> within the application to retrieve tensors
from the standalone <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> to store in a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. Details in section:
<a class="reference internal" href="#init-model-client"><span class="std std-ref">Initialize the Clients</span></a>.</p></li>
</ol>
<p><strong>The Experiment Driver Script Overview:</strong>
The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script holds the stages of the workflow
and manages their execution through the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> API.
We initialize an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>
at the beginning of the Python file and use the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> to
iteratively create, configure and launch computational kernels
on the system through the <cite>slurm</cite> launcher.
In the driver script, we use the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> to create and launch a <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance that
runs the application.</p>
<p><strong>The Experiment Driver Script Contents:</strong></p>
<ol class="arabic simple">
<li><p>Launching two standalone <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> with unique identifiers. Details in section:
<a class="reference internal" href="#launch-multiple-orch"><span class="std std-ref">Launch Multiple Orchestrators</span></a>.</p></li>
<li><p>Launching the application script with a colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. Details in section:
<a class="reference internal" href="#init-colocated-model"><span class="std std-ref">Initialize a Colocated Model</span></a>.</p></li>
<li><p>Connecting SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> within the driver script to send tensors to standalone <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>
for retrieval within the application. Details in section:
<a class="reference internal" href="#client-connect-orch"><span class="std std-ref">Create Client Connections to Orchestrators</span></a>.</p></li>
</ol>
<p>Setup and run instructions can be found <a class="reference internal" href="#run-ex-instruct"><span class="std std-ref">here</span></a></p>
<section id="the-application-script">
<span id="app-script-multi-db"></span><h4>The Application Script<a class="headerlink" href="#the-application-script" title="Permalink to this heading">#</a></h4>
<p>Applications interact with the <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>
through a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>.
In this section, we write an application script
to demonstrate how to connect SmartRedis
<code class="docutils literal notranslate"><span class="pre">Clients</span></code> in the context of multiple
launched <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>. Using the <code class="docutils literal notranslate"><span class="pre">Clients</span></code>, we retrieve tensors
from two <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> launched in the driver script, then store
the tensors in the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> must be started to use the <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> within the
application script.  Otherwise, it will fail to connect.
Find the instructions on how to launch <a class="reference internal" href="#run-ex-instruct"><span class="std std-ref">here</span></a></p>
</div>
<p>To begin, import the necessary packages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">ConfigOptions</span><span class="p">,</span> <span class="n">Client</span>
<span class="linenos">2</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos">3</span><span class="kn">from</span> <span class="nn">smartredis.error</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<section id="initialize-the-clients">
<span id="init-model-client"></span><h5>Initialize the Clients<a class="headerlink" href="#initialize-the-clients" title="Permalink to this heading">#</a></h5>
<p>To establish a connection with each <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>,
we need to initialize a new SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> for each.</p>
<section id="step-1-initialize-configoptions">
<h6>Step 1: Initialize ConfigOptions<a class="headerlink" href="#step-1-initialize-configoptions" title="Permalink to this heading">#</a></h6>
<p>Since we are launching multiple <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> within the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>,
the SmartRedis <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> object is required when initializing
a <code class="docutils literal notranslate"><span class="pre">Client</span></code> in the application.
We use the <code class="docutils literal notranslate"><span class="pre">ConfigOptions.create_from_environment</span></code>
function to create three instances of <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code>,
with one instance associated with each launched <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.
Most importantly, to associate each launched <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> to a <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> object,
the <code class="docutils literal notranslate"><span class="pre">create_from_environment</span></code> function requires specifying the unique <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> identifier
argument named <cite>db_identifier</cite>.</p>
<p>For the single-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a ConfigOptions object</span>
<span class="linenos">2</span><span class="n">single_shard_config</span> <span class="o">=</span> <span class="n">ConfigOptions</span><span class="o">.</span><span class="n">create_from_environment</span><span class="p">(</span><span class="s2">&quot;single_shard_db_identifier&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the multi-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a ConfigOptions object</span>
<span class="linenos">2</span><span class="n">multi_shard_config</span> <span class="o">=</span> <span class="n">ConfigOptions</span><span class="o">.</span><span class="n">create_from_environment</span><span class="p">(</span><span class="s2">&quot;multi_shard_db_identifier&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a ConfigOptions object</span>
<span class="linenos">2</span><span class="n">colo_config</span> <span class="o">=</span> <span class="n">ConfigOptions</span><span class="o">.</span><span class="n">create_from_environment</span><span class="p">(</span><span class="s2">&quot;colo_db_identifier&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-2-initialize-the-client-connections">
<h6>Step 2: Initialize the Client Connections<a class="headerlink" href="#step-2-initialize-the-client-connections" title="Permalink to this heading">#</a></h6>
<p>Now that we have three <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> objects, we have the
tools necessary to initialize three SmartRedis <code class="docutils literal notranslate"><span class="pre">Clients</span></code> and
establish a connection with the three <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>.
We use the SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> API to create the <code class="docutils literal notranslate"><span class="pre">Client</span></code> instances by passing in
the <code class="docutils literal notranslate"><span class="pre">ConfigOptions</span></code> objects and assigning a <cite>logger_name</cite> argument.</p>
<p>Single-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartRedis client for the single sharded database</span>
<span class="linenos">2</span><span class="n">app_single_shard_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">single_shard_config</span><span class="p">,</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Model: single shard logger&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Multi-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartRedis client for the multi sharded database</span>
<span class="linenos">2</span><span class="n">app_multi_shard_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">multi_shard_config</span><span class="p">,</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Model: multi shard logger&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartRedis client for the colocated database</span>
<span class="linenos">2</span><span class="n">colo_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">colo_config</span><span class="p">,</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Model: colo logger&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="retrieve-data-and-store-using-smartredis-client-objects">
<h5>Retrieve Data and Store Using SmartRedis Client Objects<a class="headerlink" href="#retrieve-data-and-store-using-smartredis-client-objects" title="Permalink to this heading">#</a></h5>
<p>To confirm a successful connection to each <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, we will retrieve the tensors
that we plan to store in the python driver script. After retrieving, we
store both tensors in the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.
The <code class="docutils literal notranslate"><span class="pre">Client.get_tensor</span></code> method allows
retrieval of a tensor. It requires the <cite>name</cite> of the tensor assigned
when sent to the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> via <code class="docutils literal notranslate"><span class="pre">Client.put_tensor</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Retrieve the tensor placed in driver script using the associated client</span>
<span class="linenos">2</span><span class="n">val1</span> <span class="o">=</span> <span class="n">app_single_shard_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">val2</span> <span class="o">=</span> <span class="n">app_multi_shard_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">)</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="c1"># Print message to stdout using SmartRedis Client logger</span>
<span class="linenos">6</span><span class="n">app_single_shard_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The single sharded db tensor is: </span><span class="si">{</span><span class="n">val1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">7</span><span class="n">app_multi_shard_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The multi sharded db tensor is: </span><span class="si">{</span><span class="n">val2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Later, when you run the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> driver script the following output will appear in <code class="docutils literal notranslate"><span class="pre">tutorial_model.out</span></code>
located in <code class="docutils literal notranslate"><span class="pre">getting-started-multidb/tutorial_model/</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="p">:</span> <span class="n">single</span> <span class="n">shard</span> <span class="n">logger</span><span class="o">@</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="p">:</span><span class="n">The</span> <span class="n">single</span> <span class="n">sharded</span> <span class="n">db</span> <span class="n">tensor</span> <span class="ow">is</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">Model</span><span class="p">:</span> <span class="n">multi</span> <span class="n">shard</span> <span class="n">logger</span><span class="o">@</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="p">:</span><span class="n">The</span> <span class="n">multi</span> <span class="n">sharded</span> <span class="n">db</span> <span class="n">tensor</span> <span class="ow">is</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>This output showcases that we have established a connection with multiple <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>.</p>
<p>Next, take the tensors retrieved from the standalone deployment <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> and
store them in the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> using  <code class="docutils literal notranslate"><span class="pre">Client.put_tensor(name,</span> <span class="pre">data)</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Place retrieved tensors in colocated database</span>
<span class="linenos">2</span><span class="n">colo_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">val1</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">colo_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, check if the tensors exist in the colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> using <code class="docutils literal notranslate"><span class="pre">Client.poll_tensor</span></code>.
This function queries for data in the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. The function requires the tensor name (<cite>name</cite>),
how many milliseconds to wait in between queries (<cite>poll_frequency_ms</cite>),
and the total number of times to query (<cite>num_tries</cite>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Check that tensors are in colocated database</span>
<span class="linenos">2</span><span class="n">colo_val1</span> <span class="o">=</span> <span class="n">colo_client</span><span class="o">.</span><span class="n">poll_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">colo_val2</span> <span class="o">=</span> <span class="n">colo_client</span><span class="o">.</span><span class="n">poll_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">4</span><span class="c1"># Print message to stdout using SmartRedis Client logger</span>
<span class="linenos">5</span><span class="n">colo_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The colocated db has tensor_1: </span><span class="si">{</span><span class="n">colo_val1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">6</span><span class="n">colo_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The colocated db has tensor_2: </span><span class="si">{</span><span class="n">colo_val2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The output will be as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="p">:</span> <span class="n">colo</span> <span class="n">logger</span><span class="o">@</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="p">:</span><span class="n">The</span> <span class="n">colocated</span> <span class="n">db</span> <span class="n">has</span> <span class="n">tensor_1</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">Model</span><span class="p">:</span> <span class="n">colo</span> <span class="n">logger</span><span class="o">@</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="o">-</span><span class="mi">00</span><span class="p">:</span><span class="n">The</span> <span class="n">colocated</span> <span class="n">db</span> <span class="n">has</span> <span class="n">tensor_2</span><span class="p">:</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
</section>
<section id="the-experiment-driver-script">
<h4>The Experiment Driver Script<a class="headerlink" href="#the-experiment-driver-script" title="Permalink to this heading">#</a></h4>
<p>To run the previous application, we must define workflow stages within a workload.
Defining workflow stages requires the utilization of functions associated
with the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object. The <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object is intended to be instantiated
once and utilized throughout the workflow runtime.
In this example, we instantiate an <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> object with the name <code class="docutils literal notranslate"><span class="pre">getting-started-multidb</span></code>.
We setup the SmartSim <code class="docutils literal notranslate"><span class="pre">logger</span></code> to output information from the Experiment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">smartsim</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">smartsim.log</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">exe_ex</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span>
<span class="linenos"> 8</span><span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;Multidb Experiment Log&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="c1"># Initialize the Experiment</span>
<span class="linenos">10</span><span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="s2">&quot;getting-started-multidb&quot;</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="launch-multiple-orchestrators">
<span id="launch-multiple-orch"></span><h5>Launch Multiple Orchestrators<a class="headerlink" href="#launch-multiple-orchestrators" title="Permalink to this heading">#</a></h5>
<p>In the context of this <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, it’s essential to create and launch
the <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> as a preliminary step before any other components since
the application script requests tensors from the launched <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>.</p>
<p>We aim to showcase the multi-Orchestrator automation capabilities of SmartSim, so we
create two <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> in the workflow: a single-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> and a
multi-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
<section id="step-1-initialize-orchestrators">
<h6>Step 1: Initialize Orchestrators<a class="headerlink" href="#step-1-initialize-orchestrators" title="Permalink to this heading">#</a></h6>
<p>To create an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, utilize the <code class="docutils literal notranslate"><span class="pre">Experiment.create_database</span></code> function.
The function requires specifying a unique
<code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> identifier argument named <cite>db_identifier</cite> to launch multiple <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>.
This step is necessary to connect to <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> outside of the driver script.
We will use the <cite>db_identifier</cite> names we specified in the application script.</p>
<p>For the single-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a single sharded database</span>
<span class="linenos">2</span><span class="n">single_shard_db</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">db_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;ib0&quot;</span><span class="p">,</span> <span class="n">db_identifier</span><span class="o">=</span><span class="s2">&quot;single_shard_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">single_shard_db</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>For the multi-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a multi sharded database</span>
<span class="linenos">2</span><span class="n">multi_shard_db</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">6380</span><span class="p">,</span> <span class="n">db_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;ib0&quot;</span><span class="p">,</span> <span class="n">db_identifier</span><span class="o">=</span><span class="s2">&quot;multi_shard_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">multi_shard_db</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calling <code class="docutils literal notranslate"><span class="pre">exp.generate</span></code> will create two subfolders
(one for each <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> created in the previous step)
whose names are based on the <cite>db_identifier</cite> of that <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.
In this example, the Experiment folder is
named <code class="docutils literal notranslate"><span class="pre">getting-started-multidb/</span></code>. Within this folder, two <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> subfolders will
be created, namely <code class="docutils literal notranslate"><span class="pre">single_shard_db_identifier/</span></code> and <code class="docutils literal notranslate"><span class="pre">multi_shard_db_identifier/</span></code>.</p>
</div>
</section>
<section id="step-2-start">
<h6>Step 2: Start<a class="headerlink" href="#step-2-start" title="Permalink to this heading">#</a></h6>
<p>Next, to launch the <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>,
pass the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> instances to <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Launch the single and multi sharded database</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">single_shard_db</span><span class="p">,</span> <span class="n">multi_shard_db</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code> function launches the <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> for use within the workflow. In other words, the function
deploys the <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code> on the allocated compute resources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By setting <cite>summary=True</cite>, SmartSim will print a summary of the
<code class="docutils literal notranslate"><span class="pre">Experiment</span></code> before it is launched. After printing the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> summary,
the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> is paused for 10 seconds giving the user time to
briefly scan the summary contents. If we set <cite>summary=False</cite>, then the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>
would be launched immediately with no summary.</p>
</div>
</section>
</section>
<section id="create-client-connections-to-orchestrators">
<span id="client-connect-orch"></span><h5>Create Client Connections to Orchestrators<a class="headerlink" href="#create-client-connections-to-orchestrators" title="Permalink to this heading">#</a></h5>
<p>The SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> object contains functions that manipulate, send, and receive
data within the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. Each <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> has a single, dedicated SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>.
Begin by initializing a SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code> object per launched <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>.</p>
<p>To create a designated SmartRedis <code class="docutils literal notranslate"><span class="pre">Client</span></code>, you need to specify the address of the target
running <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. You can easily retrieve this address using the <code class="docutils literal notranslate"><span class="pre">Orchestrator.get_address</span></code> function.</p>
<p>For the single-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize SmartRedis client for single sharded database</span>
<span class="linenos">2</span><span class="n">driver_client_single_shard</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">single_shard_db</span><span class="o">.</span><span class="n">get_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Single shard db logger&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the multi-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize SmartRedis client for multi sharded database</span>
<span class="linenos">2</span><span class="n">driver_client_multi_shard</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">multi_shard_db</span><span class="o">.</span><span class="n">get_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Multi shard db logger&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="store-data-using-clients">
<h5>Store Data Using Clients<a class="headerlink" href="#store-data-using-clients" title="Permalink to this heading">#</a></h5>
<p>In the application script, we retrieved two NumPy tensors.
To support the apps functionality, we will create two
NumPy arrays in the python driver script and send them to the a <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>. To
accomplish this, we use the <code class="docutils literal notranslate"><span class="pre">Client.put_tensor</span></code> function with the respective
<code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> <cite>client</cite> instances.</p>
<p>For the single-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Create NumPy array</span>
<span class="linenos">2</span><span class="n">array_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="linenos">3</span><span class="c1"># Use single shard db SmartRedis client to place tensor in single sharded db</span>
<span class="linenos">4</span><span class="n">driver_client_single_shard</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">array_1</span><span class="p">)</span>
</pre></div>
</div>
<p>For the multi-sharded <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Create NumPy array</span>
<span class="linenos">2</span><span class="n">array_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="linenos">3</span><span class="c1"># Use single shard db SmartRedis client to place tensor in multi sharded db</span>
<span class="linenos">4</span><span class="n">driver_client_multi_shard</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="n">array_2</span><span class="p">)</span>
</pre></div>
</div>
<p>Lets check to make sure the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> tensors do not exist in the incorrect <code class="docutils literal notranslate"><span class="pre">Orchestrators</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Check that tensors are in correct databases</span>
<span class="linenos">2</span><span class="n">check_single_shard_db_tensor_incorrect</span> <span class="o">=</span> <span class="n">driver_client_single_shard</span><span class="o">.</span><span class="n">key_exists</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">check_multi_shard_db_tensor_incorrect</span> <span class="o">=</span> <span class="n">driver_client_multi_shard</span><span class="o">.</span><span class="n">key_exists</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="linenos">4</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The multi shard array key exists in the incorrect database: </span><span class="si">{</span><span class="n">check_single_shard_db_tensor_incorrect</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">5</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The single shard array key exists in the incorrect database: </span><span class="si">{</span><span class="n">check_multi_shard_db_tensor_incorrect</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When you run the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, the following output will appear:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">system</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">com</span> <span class="n">SmartSim</span><span class="p">[</span><span class="c1">#####] INFO The multi shard array key exists in the incorrect database: False</span>
<span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">system</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">com</span> <span class="n">SmartSim</span><span class="p">[</span><span class="c1">#####] INFO The single shard array key exists in the incorrect database: False</span>
</pre></div>
</div>
</section>
<section id="initialize-a-colocated-model">
<span id="init-colocated-model"></span><h5>Initialize a Colocated Model<a class="headerlink" href="#initialize-a-colocated-model" title="Permalink to this heading">#</a></h5>
<p>In the next stage of the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, we
launch the application script with a co-located <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>
by configuring and creating
a SmartSim colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code>.</p>
<section id="id12">
<h6>Step 1: Configure<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h6>
<p>You can specify the run settings of a <code class="docutils literal notranslate"><span class="pre">Model</span></code>.
In this <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>, we invoke the Python interpreter to run
the python script defined in section: <a class="reference internal" href="#app-script-multi-db"><span class="std std-ref">The Application Script</span></a>.
To configure this into a SmartSim <code class="docutils literal notranslate"><span class="pre">Model</span></code>, we use the <code class="docutils literal notranslate"><span class="pre">Experiment.create_run_settings</span></code> function.
The function returns a <code class="docutils literal notranslate"><span class="pre">RunSettings</span></code> object.
When initializing the RunSettings object,
we specify the path to the application file,
<cite>application_script.py</cite>, for
<code class="docutils literal notranslate"><span class="pre">exe_args</span></code>, and the run command for <code class="docutils literal notranslate"><span class="pre">exe</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a RunSettings object</span>
<span class="linenos">2</span><span class="n">model_settings</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_run_settings</span><span class="p">(</span><span class="n">exe</span><span class="o">=</span><span class="n">exe_ex</span><span class="p">,</span> <span class="n">exe_args</span><span class="o">=</span><span class="s2">&quot;./path/to/application_script.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will have to change the <cite>exe_args</cite> argument to the path of the application script
on your machine to run the example.</p>
</div>
<p>With the <code class="docutils literal notranslate"><span class="pre">RunSettings</span></code> instance,
configure the the distribution of computational tasks (<code class="docutils literal notranslate"><span class="pre">RunSettings.set_nodes</span></code>) and the number of instances
the script is execute on each node (<code class="docutils literal notranslate"><span class="pre">RunSettings.set_tasks_per_node</span></code>). In this
example, we specify to SmartSim that we intend to execute the script once on a single node.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Configure RunSettings object</span>
<span class="linenos">2</span><span class="n">model_settings</span><span class="o">.</span><span class="n">set_nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">model_settings</span><span class="o">.</span><span class="n">set_tasks_per_node</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id13">
<h6>Step 2: Initialize<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h6>
<p>Next, create a <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance using the <code class="docutils literal notranslate"><span class="pre">Experiment.create_model</span></code>.
Pass the <code class="docutils literal notranslate"><span class="pre">model_settings</span></code> object as an argument
to the <code class="docutils literal notranslate"><span class="pre">create_model</span></code> function and assign to the variable <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Initialize a SmartSim Model</span>
<span class="linenos">2</span><span class="n">model</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;colo_model&quot;</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="step-2-colocate">
<h6>Step 2: Colocate<a class="headerlink" href="#step-2-colocate" title="Permalink to this heading">#</a></h6>
<p>To colocate the <code class="docutils literal notranslate"><span class="pre">Model</span></code>, use the <code class="docutils literal notranslate"><span class="pre">Model.colocate_db_uds</span></code> function to
Colocate an <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> instance with this <code class="docutils literal notranslate"><span class="pre">Model</span></code> over
a Unix domain socket connection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Colocate the Model</span>
<span class="linenos">2</span><span class="n">model</span><span class="o">.</span><span class="n">colocate_db_tcp</span><span class="p">(</span><span class="n">db_identifier</span><span class="o">=</span><span class="s2">&quot;colo_db_identifier&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This method will initialize settings which add an unsharded
<code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> to this <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance. Only this <code class="docutils literal notranslate"><span class="pre">Model</span></code> will be able
to communicate with this colocated <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> by using the loopback TCP interface.</p>
</section>
<section id="step-3-start">
<h6>Step 3: Start<a class="headerlink" href="#step-3-start" title="Permalink to this heading">#</a></h6>
<p>Next, launch the colocated <code class="docutils literal notranslate"><span class="pre">Model</span></code> instance using the <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Launch the colocated Model</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We set <cite>block=True</cite>,
so that <code class="docutils literal notranslate"><span class="pre">Experiment.start</span></code> waits until the last <code class="docutils literal notranslate"><span class="pre">Model</span></code> has finished
before returning: it will act like a job monitor, letting us know
if processes run, complete, or fail.</p>
</div>
</section>
</section>
<section id="cleanup-experiment">
<h5>Cleanup Experiment<a class="headerlink" href="#cleanup-experiment" title="Permalink to this heading">#</a></h5>
<p>Finally, use the <code class="docutils literal notranslate"><span class="pre">Experiment.stop</span></code> function to stop the standard <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> instances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Co-located <code class="docutils literal notranslate"><span class="pre">Orchestrator``s</span> <span class="pre">are</span> <span class="pre">stopped</span> <span class="pre">when</span> <span class="pre">their</span> <span class="pre">associated</span> <span class="pre">``Model</span></code>’s are stopped.</p>
</div>
<p>Print the workflow summary with <code class="docutils literal notranslate"><span class="pre">Experiment.summary</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># Tear down the single and multi sharded databases</span>
<span class="linenos">2</span><span class="n">exp</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">single_shard_db</span><span class="p">,</span> <span class="n">multi_shard_db</span><span class="p">)</span>
<span class="linenos">3</span><span class="c1"># Print the Experiment summary</span>
<span class="linenos">4</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
<p>When you run the experiment, the following output will appear:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="n">system</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">com</span> <span class="n">SmartSim</span><span class="p">[</span><span class="c1">#####]INFO</span>
<span class="o">|</span>    <span class="o">|</span> <span class="n">Name</span>                         <span class="o">|</span> <span class="n">Entity</span><span class="o">-</span><span class="n">Type</span>   <span class="o">|</span> <span class="n">JobID</span>       <span class="o">|</span> <span class="n">RunID</span>   <span class="o">|</span> <span class="n">Time</span>    <span class="o">|</span> <span class="n">Status</span>    <span class="o">|</span> <span class="n">Returncode</span>   <span class="o">|</span>
<span class="o">|----|------------------------------|---------------|-------------|---------|---------|-----------|--------------|</span>
<span class="o">|</span> <span class="mi">0</span>  <span class="o">|</span> <span class="n">colo_model</span>                   <span class="o">|</span> <span class="n">Model</span>         <span class="o">|</span> <span class="mf">1556529.5</span>   <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="mf">1.7437</span>  <span class="o">|</span> <span class="n">Completed</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>  <span class="o">|</span> <span class="n">single_shard_db_identifier_0</span> <span class="o">|</span> <span class="n">DBNode</span>        <span class="o">|</span> <span class="mf">1556529.3</span>   <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="mf">68.8732</span> <span class="o">|</span> <span class="n">Cancelled</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span>  <span class="o">|</span> <span class="n">multi_shard_db_identifier_0</span>  <span class="o">|</span> <span class="n">DBNode</span>        <span class="o">|</span> <span class="mf">1556529.4</span><span class="o">+</span><span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span>       <span class="o">|</span> <span class="mf">45.5139</span> <span class="o">|</span> <span class="n">Cancelled</span> <span class="o">|</span> <span class="mi">0</span>            <span class="o">|</span>
</pre></div>
</div>
</section>
</section>
<section id="how-to-run-the-example">
<span id="run-ex-instruct"></span><h4>How to Run the Example<a class="headerlink" href="#how-to-run-the-example" title="Permalink to this heading">#</a></h4>
<p>Below are the steps to run the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code>. Find the
<a class="reference internal" href="#multi-exp-source-code"><span class="std std-ref">experiment source code</span></a>
and <a class="reference internal" href="#multi-app-source-code"><span class="std std-ref">application source code</span></a>
below in the respective subsections.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The example assumes that you have already installed and built
SmartSim and SmartRedis. Please refer to Section <a class="reference internal" href="installation_instructions/basic.html#basic-install-ss"><span class="std std-ref">Basic Installation</span></a>
for further details. For simplicity, we assume that you are
running on a SLURM-based HPC-platform. Refer to the steps below
for more details.</p>
</div>
<dl>
<dt>Step 1<span class="classifier">Setup your directory tree</span></dt><dd><p>Your directory tree should look similar to below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SmartSim</span><span class="o">/</span>
<span class="n">SmartRedis</span><span class="o">/</span>
<span class="n">Multi</span><span class="o">-</span><span class="n">db</span><span class="o">-</span><span class="n">example</span><span class="o">/</span>
  <span class="n">application_script</span><span class="o">.</span><span class="n">py</span>
  <span class="n">experiment_script</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>You can find the application and <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> source code in subsections below.</p>
</dd>
<dt>Step 2<span class="classifier">Install and Build SmartSim</span></dt><dd><p>This example assumes you have installed SmartSim and SmartRedis in your
Python environment. We also assume that you have built SmartSim with
the necessary modules for the machine you are running on.</p>
</dd>
<dt>Step 3<span class="classifier">Change the <cite>exe_args</cite> file path</span></dt><dd><p>When configuring the colocated model in <cite>experiment_script.py</cite>,
we pass the file path of <cite>application_script.py</cite> to the <cite>exe_args</cite> argument
on line 33 in <a class="reference internal" href="#multi-exp-source-code"><span class="std std-ref">experiment_script.py</span></a>.
Edit this argument to the file path of your <cite>application_script.py</cite></p>
</dd>
<dt>Step 4<span class="classifier">Run the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code></span></dt><dd><p>Finally, run the <code class="docutils literal notranslate"><span class="pre">Experiment</span></code> with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">experiment_script.py</span></code>.</p>
</dd>
</dl>
<section id="application-source-code">
<span id="multi-app-source-code"></span><h5>Application Source Code<a class="headerlink" href="#application-source-code" title="Permalink to this heading">#</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">ConfigOptions</span><span class="p">,</span> <span class="n">Client</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">smartredis.error</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># Initialize a ConfigOptions object</span>
<span class="linenos"> 6</span><span class="n">single_shard_config</span> <span class="o">=</span> <span class="n">ConfigOptions</span><span class="o">.</span><span class="n">create_from_environment</span><span class="p">(</span><span class="s2">&quot;single_shard_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="c1"># Initialize a SmartRedis client for the single sharded database</span>
<span class="linenos"> 8</span><span class="n">app_single_shard_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">single_shard_config</span><span class="p">,</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Model: single shard logger&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Initialize a ConfigOptions object</span>
<span class="linenos">11</span><span class="n">multi_shard_config</span> <span class="o">=</span> <span class="n">ConfigOptions</span><span class="o">.</span><span class="n">create_from_environment</span><span class="p">(</span><span class="s2">&quot;multi_shard_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">12</span><span class="c1"># Initialize a SmartRedis client for the multi sharded database</span>
<span class="linenos">13</span><span class="n">app_multi_shard_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">multi_shard_config</span><span class="p">,</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Model: multi shard logger&quot;</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span><span class="c1"># Initialize a ConfigOptions object</span>
<span class="linenos">16</span><span class="n">colo_config</span> <span class="o">=</span> <span class="n">ConfigOptions</span><span class="o">.</span><span class="n">create_from_environment</span><span class="p">(</span><span class="s2">&quot;colo_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">17</span><span class="c1"># Initialize a SmartRedis client for the colocated database</span>
<span class="linenos">18</span><span class="n">colo_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">colo_config</span><span class="p">,</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Model: colo logger&quot;</span><span class="p">)</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1"># Retrieve the tensor placed in driver script using the associated client</span>
<span class="linenos">21</span><span class="n">val1</span> <span class="o">=</span> <span class="n">app_single_shard_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">val2</span> <span class="o">=</span> <span class="n">app_multi_shard_client</span><span class="o">.</span><span class="n">get_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">)</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1"># Print message to stdout using SmartRedis Client logger</span>
<span class="linenos">25</span><span class="n">app_single_shard_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The single sharded db tensor is: </span><span class="si">{</span><span class="n">val1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">26</span><span class="n">app_multi_shard_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The multi sharded db tensor is: </span><span class="si">{</span><span class="n">val2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1"># Place retrieved tensors in colocated database</span>
<span class="linenos">29</span><span class="n">colo_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">val1</span><span class="p">)</span>
<span class="linenos">30</span><span class="n">colo_client</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="n">val2</span><span class="p">)</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="c1"># Check that tensors are in colocated database</span>
<span class="linenos">33</span><span class="n">colo_val1</span> <span class="o">=</span> <span class="n">colo_client</span><span class="o">.</span><span class="n">poll_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">34</span><span class="n">colo_val2</span> <span class="o">=</span> <span class="n">colo_client</span><span class="o">.</span><span class="n">poll_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos">35</span><span class="c1"># Print message to stdout using SmartRedis Client logger</span>
<span class="linenos">36</span><span class="n">colo_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The colocated db has tensor_1: </span><span class="si">{</span><span class="n">colo_val1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">37</span><span class="n">colo_client</span><span class="o">.</span><span class="n">log_data</span><span class="p">(</span><span class="n">LLInfo</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The colocated db has tensor_2: </span><span class="si">{</span><span class="n">colo_val2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="experiment-source-code">
<span id="multi-exp-source-code"></span><h5>Experiment Source Code<a class="headerlink" href="#experiment-source-code" title="Permalink to this heading">#</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">smartredis</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="linenos"> 3</span><span class="kn">from</span> <span class="nn">smartsim</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">smartsim.log</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">sys</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">exe_ex</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span>
<span class="linenos"> 8</span><span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;Multidb Experiment Log&quot;</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="c1"># Initialize the Experiment</span>
<span class="linenos">10</span><span class="n">exp</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="s2">&quot;getting-started-multidb&quot;</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="c1"># Initialize a single sharded database</span>
<span class="linenos">13</span><span class="n">single_shard_db</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">db_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;ib0&quot;</span><span class="p">,</span> <span class="n">db_identifier</span><span class="o">=</span><span class="s2">&quot;single_shard_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">14</span><span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">single_shard_db</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="c1"># Initialize a multi sharded database</span>
<span class="linenos">17</span><span class="n">multi_shard_db</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_database</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">6380</span><span class="p">,</span> <span class="n">db_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;ib0&quot;</span><span class="p">,</span> <span class="n">db_identifier</span><span class="o">=</span><span class="s2">&quot;multi_shard_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">18</span><span class="n">exp</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">multi_shard_db</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1"># Launch the single and multi sharded database</span>
<span class="linenos">21</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">single_shard_db</span><span class="p">,</span> <span class="n">multi_shard_db</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">22</span>
<span class="linenos">23</span><span class="c1"># Initialize SmartRedis client for single sharded database</span>
<span class="linenos">24</span><span class="n">driver_client_single_shard</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">single_shard_db</span><span class="o">.</span><span class="n">get_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Single shard db logger&quot;</span><span class="p">)</span>
<span class="linenos">25</span><span class="c1"># Initialize SmartRedis client for multi sharded database</span>
<span class="linenos">26</span><span class="n">driver_client_multi_shard</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">multi_shard_db</span><span class="o">.</span><span class="n">get_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">logger_name</span><span class="o">=</span><span class="s2">&quot;Multi shard db logger&quot;</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span><span class="c1"># Create NumPy array</span>
<span class="linenos">29</span><span class="n">array_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="linenos">30</span><span class="c1"># Use single shard db SmartRedis client to place tensor in single sharded db</span>
<span class="linenos">31</span><span class="n">driver_client_single_shard</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">,</span> <span class="n">array_1</span><span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="c1"># Create NumPy array</span>
<span class="linenos">34</span><span class="n">array_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="linenos">35</span><span class="c1"># Use single shard db SmartRedis client to place tensor in multi sharded db</span>
<span class="linenos">36</span><span class="n">driver_client_multi_shard</span><span class="o">.</span><span class="n">put_tensor</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">,</span> <span class="n">array_2</span><span class="p">)</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="c1"># Check that tensors are in correct databases</span>
<span class="linenos">39</span><span class="n">check_single_shard_db_tensor_incorrect</span> <span class="o">=</span> <span class="n">driver_client_single_shard</span><span class="o">.</span><span class="n">key_exists</span><span class="p">(</span><span class="s2">&quot;tensor_2&quot;</span><span class="p">)</span>
<span class="linenos">40</span><span class="n">check_multi_shard_db_tensor_incorrect</span> <span class="o">=</span> <span class="n">driver_client_multi_shard</span><span class="o">.</span><span class="n">key_exists</span><span class="p">(</span><span class="s2">&quot;tensor_1&quot;</span><span class="p">)</span>
<span class="linenos">41</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The multi shard array key exists in the incorrect database: </span><span class="si">{</span><span class="n">check_single_shard_db_tensor_incorrect</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">42</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The single shard array key exists in the incorrect database: </span><span class="si">{</span><span class="n">check_multi_shard_db_tensor_incorrect</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="c1"># Initialize a RunSettings object</span>
<span class="linenos">45</span><span class="n">model_settings</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_run_settings</span><span class="p">(</span><span class="n">exe</span><span class="o">=</span><span class="n">exe_ex</span><span class="p">,</span> <span class="n">exe_args</span><span class="o">=</span><span class="s2">&quot;./path/to/application_script.py&quot;</span><span class="p">)</span>
<span class="linenos">46</span><span class="c1"># Configure RunSettings object</span>
<span class="linenos">47</span><span class="n">model_settings</span><span class="o">.</span><span class="n">set_nodes</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">48</span><span class="n">model_settings</span><span class="o">.</span><span class="n">set_tasks_per_node</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">49</span><span class="c1"># Initialize a SmartSim Model</span>
<span class="linenos">50</span><span class="n">model</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span><span class="s2">&quot;colo_model&quot;</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">)</span>
<span class="linenos">51</span><span class="c1"># Colocate the Model</span>
<span class="linenos">52</span><span class="n">model</span><span class="o">.</span><span class="n">colocate_db_tcp</span><span class="p">(</span><span class="n">db_identifier</span><span class="o">=</span><span class="s2">&quot;colo_db_identifier&quot;</span><span class="p">)</span>
<span class="linenos">53</span><span class="c1"># Launch the colocated Model</span>
<span class="linenos">54</span><span class="n">exp</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">55</span>
<span class="linenos">56</span><span class="c1"># Tear down the single and multi sharded databases</span>
<span class="linenos">57</span><span class="n">exp</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">single_shard_db</span><span class="p">,</span> <span class="n">multi_shard_db</span><span class="p">)</span>
<span class="linenos">58</span><span class="c1"># Print the Experiment summary</span>
<span class="linenos">59</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ensemble.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ensemble</p>
      </div>
    </a>
    <a class="right-next"
       href="ss_logger.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Logger</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standalone-deployment">Standalone Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#application-script">Application Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#client-initialization">Client Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-retrieval">Data Retrieval</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-storage">Data Storage</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-driver-script">Experiment Driver Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#orchestrator-initialization">Orchestrator Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Client Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Data Storage</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#model-initialization">Model Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#file-generation">File Generation</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#entity-deployment">Entity Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-start-orchestrator">Step 1: Start Orchestrator</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-start-model">Step 2: Start Model</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#data-polling">Data Polling</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup">Cleanup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-deployment">Colocated Deployment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Overview</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-orch-app-script">Application Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Client Initialization</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Data Storage</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Data Retrieval</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-orch-driver-script">Experiment Driver Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#colocated-model-initialization">Colocated Model Initialization</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-configure">Step 1: Configure</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-initialize">Step 2: Initialize</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-colocate">Step 3: Colocate</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-generate-files">Step 4: Generate Files</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-start">Step 5: Start</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Cleanup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-orchestrators">Multiple Orchestrators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-orchestrator-example">Multiple Orchestrator Example</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-application-script">The Application Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-the-clients">Initialize the Clients</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-initialize-configoptions">Step 1: Initialize ConfigOptions</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-initialize-the-client-connections">Step 2: Initialize the Client Connections</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data-and-store-using-smartredis-client-objects">Retrieve Data and Store Using SmartRedis Client Objects</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-experiment-driver-script">The Experiment Driver Script</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#launch-multiple-orchestrators">Launch Multiple Orchestrators</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-initialize-orchestrators">Step 1: Initialize Orchestrators</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-start">Step 2: Start</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#create-client-connections-to-orchestrators">Create Client Connections to Orchestrators</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#store-data-using-clients">Store Data Using Clients</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#initialize-a-colocated-model">Initialize a Colocated Model</a><ul class="nav section-nav flex-column">
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Step 1: Configure</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Step 2: Initialize</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-colocate">Step 2: Colocate</a></li>
<li class="toc-h6 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-start">Step 3: Start</a></li>
</ul>
</li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#cleanup-experiment">Cleanup Experiment</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-the-example">How to Run the Example</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#application-source-code">Application Source Code</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#experiment-source-code">Experiment Source Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Cray Labs
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021-2024, Hewlett Packard Enterprise.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Questions? You can contact <a href="mailto:craylabs@hpe.com">contact us</a> or <a href="https://join.slack.com/t/craylabs/shared_invite/zt-nw3ag5z5-5PS4tIXBfufu1bIvvr71UA">join us on Slack!</a>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>